<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <title>Zuschnitt Reste</title>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
    .print-button { position: fixed; top: 10px; right: 10px; font-size: 16px; }
    @media print { .print-button { display: none; } body { margin: 0; background: #fff; } }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 50px; }
    .table { display: flex; flex-direction: column; gap: 6px; background: #fff; padding: 8px; border: 1px solid #ccc; font-size: 12px; }
    label { font-weight: bold; font-size: 12px; }
    input { padding: 4px; font-size: 12px; border: 1px solid #bbb; }
    input[readonly] { background: #f2f2f2; }
    .artikel-row { display: flex; align-items: center; gap: 8px; }
    .artikelnummer { width: 80px; }
    .barcode { width: 120px; height: 40px; }
    .preisRabatt { font-size: 24px; font-weight: bold; color: red; background: #fff0f0; border: 2px solid red; padding: 6px; }
    @page { size: A4 landscape; margin: 10mm; }
    @media print { .grid { transform: scale(0.9); transform-origin: top left; } .table { font-size: 10px; } .preisRabatt { font-size: 20px; } }
  </style>
</head>
<body>
  <button class="print-button" onclick="window.print()">üñ®Ô∏è Drucken</button>

  <div class="grid">
    <!-- 6 Tabellen -->
    <div class="table">
      <label>Artikelnummer:</label>
      <div class="artikel-row"><input type="text" class="artikelnummer"><svg class="barcode"></svg></div>
      <label>Bezeichnung:</label><input type="text" class="bezeichnung" readonly>
      <label>St√§rke:</label><input type="text" class="staerke" readonly>
      <label>L√§nge (mm):</label><input type="number" class="laenge">
      <label>Breite (mm):</label><input type="number" class="breite">
      <label>Fl√§che (m¬≤):</label><input type="text" class="flaeche" readonly>
      <label>Preis:</label><input type="text" class="preis" readonly>
      <label>Neuer Preis (mit 50% Nachlass):</label><input type="text" class="preisRabatt" readonly>
    </div>

    <div class="table">
      <label>Artikelnummer:</label>
      <div class="artikel-row"><input type="text" class="artikelnummer"><svg class="barcode"></svg></div>
      <label>Bezeichnung:</label><input type="text" class="bezeichnung" readonly>
      <label>St√§rke:</label><input type="text" class="staerke" readonly>
      <label>L√§nge (mm):</label><input type="number" class="laenge">
      <label>Breite (mm):</label><input type="number" class="breite">
      <label>Fl√§che (m¬≤):</label><input type="text" class="flaeche" readonly>
      <label>Preis:</label><input type="text" class="preis" readonly>
      <label>Neuer Preis (mit 50% Nachlass):</label><input type="text" class="preisRabatt" readonly>
    </div>

    <div class="table">
      <label>Artikelnummer:</label>
      <div class="artikel-row"><input type="text" class="artikelnummer"><svg class="barcode"></svg></div>
      <label>Bezeichnung:</label><input type="text" class="bezeichnung" readonly>
      <label>St√§rke:</label><input type="text" class="staerke" readonly>
      <label>L√§nge (mm):</label><input type="number" class="laenge">
      <label>Breite (mm):</label><input type="number" class="breite">
      <label>Fl√§che (m¬≤):</label><input type="text" class="flaeche" readonly>
      <label>Preis:</label><input type="text" class="preis" readonly>
      <label>Neuer Preis (mit 50% Nachlass):</label><input type="text" class="preisRabatt" readonly>
    </div>

    <div class="table">
      <label>Artikelnummer:</label>
      <div class="artikel-row"><input type="text" class="artikelnummer"><svg class="barcode"></svg></div>
      <label>Bezeichnung:</label><input type="text" class="bezeichnung" readonly>
      <label>St√§rke:</label><input type="text" class="staerke" readonly>
      <label>L√§nge (mm):</label><input type="number" class="laenge">
      <label>Breite (mm):</label><input type="number" class="breite">
      <label>Fl√§che (m¬≤):</label><input type="text" class="flaeche" readonly>
      <label>Preis:</label><input type="text" class="preis" readonly>
      <label>Neuer Preis (mit 50% Nachlass):</label><input type="text" class="preisRabatt" readonly>
    </div>

    <div class="table">
      <label>Artikelnummer:</label>
      <div class="artikel-row"><input type="text" class="artikelnummer"><svg class="barcode"></svg></div>
      <label>Bezeichnung:</label><input type="text" class="bezeichnung" readonly>
      <label>St√§rke:</label><input type="text" class="staerke" readonly>
      <label>L√§nge (mm):</label><input type="number" class="laenge">
      <label>Breite (mm):</label><input type="number" class="breite">
      <label>Fl√§che (m¬≤):</label><input type="text" class="flaeche" readonly>
      <label>Preis:</label><input type="text" class="preis" readonly>
      <label>Neuer Preis (mit 50% Nachlass):</label><input type="text" class="preisRabatt" readonly>
    </div>

    <div class="table">
      <label>Artikelnummer:</label>
      <div class="artikel-row"><input type="text" class="artikelnummer"><svg class="barcode"></svg></div>
      <label>Bezeichnung:</label><input type="text" class="bezeichnung" readonly>
      <label>St√§rke:</label><input type="text" class="staerke" readonly>
      <label>L√§nge (mm):</label><input type="number" class="laenge">
      <label>Breite (mm):</label><input type="number" class="breite">
      <label>Fl√§che (m¬≤):</label><input type="text" class="flaeche" readonly>
      <label>Preis:</label><input type="text" class="preis" readonly>
      <label>Neuer Preis (mit 50% Nachlass):</label><input type="text" class="preisRabatt" readonly>
    </div>
  </div>

  <script>
    let ARTIKEL_INDEX = null;

    async function ladeArtikelListe() {
      if (ARTIKEL_INDEX) return ARTIKEL_INDEX;
      try {
        const response = await fetch('./artikel_liste.json');
        if (!response.ok) throw new Error("HTTP " + response.status);
        ARTIKEL_INDEX = await response.json();
        return ARTIKEL_INDEX;
      } catch (e) {
        console.error("Fehler beim Laden artikel_liste.json", e);
        ARTIKEL_INDEX = {};
        return ARTIKEL_INDEX;
      }
    }

    async function berechne(table) {
      const artikelnummer = String(table.querySelector('.artikelnummer').value || '').trim();
      const laenge = parseFloat(table.querySelector('.laenge').value) || 0;
      const breite = parseFloat(table.querySelector('.breite').value) || 0;
      const flaeche = (laenge * breite) / 1_000_000;
      table.querySelector('.flaeche').value = flaeche >
